---
http_interactions:
- request:
    method: post
    uri: http://<API_ENDPOINT>:9000/api/alert
    body:
      encoding: UTF-8
      string: '{"title":"Test Alert","description":"test","type":"test","source":"test","sourceRef":"09ceff4083ae4893228b"}'
    headers:
      Accept-Encoding:
      - gzip;q=1.0,deflate;q=0.6,identity;q=0.3
      Accept:
      - "*/*"
      User-Agent:
      - Ruby
      Host:
      - "<API_ENDPOINT>:9000"
      Content-Type:
      - application/json
      Authorization:
      - Bearer <API_KEY>
  response:
    status:
      code: 201
      message: Created
    headers:
      Date:
      - Sat, 30 Nov 2019 01:47:24 GMT
      Content-Type:
      - application/json
      Content-Length:
      - '457'
    body:
      encoding: UTF-8
      string: '{"date":1575078443917,"severity":2,"_routing":"15be1f4753cf16c4bf19ab0ff31567ac","customFields":{},"_type":"alert","description":"test","lastSyncDate":1575078443917,"source":"test","type":"test","follow":true,"title":"Test
        Alert","createdAt":1575078443915,"_parent":null,"createdBy":"test","tlp":2,"_id":"15be1f4753cf16c4bf19ab0ff31567ac","id":"15be1f4753cf16c4bf19ab0ff31567ac","sourceRef":"09ceff4083ae4893228b","_version":1,"artifacts":[],"status":"New"}'
    http_version: 
  recorded_at: Sat, 30 Nov 2019 01:47:25 GMT
- request:
    method: post
    uri: http://<API_ENDPOINT>:9000/api/case
    body:
      encoding: UTF-8
      string: '{"title":"Test Alert","description":"test"}'
    headers:
      Accept-Encoding:
      - gzip;q=1.0,deflate;q=0.6,identity;q=0.3
      Accept:
      - "*/*"
      User-Agent:
      - Ruby
      Host:
      - "<API_ENDPOINT>:9000"
      Content-Type:
      - application/json
      Authorization:
      - Bearer <API_KEY>
  response:
    status:
      code: 201
      message: Created
    headers:
      Date:
      - Sat, 30 Nov 2019 01:47:25 GMT
      Content-Type:
      - application/json
      Content-Length:
      - '364'
    body:
      encoding: UTF-8
      string: '{"owner":"test","severity":2,"_routing":"AW65_cCn7fbOoAgpbfqM","flag":false,"customFields":{},"_type":"case","description":"test","title":"Test
        Alert","createdAt":1575078444256,"_parent":null,"createdBy":"test","caseId":13,"tlp":2,"metrics":{},"_id":"AW65_cCn7fbOoAgpbfqM","id":"AW65_cCn7fbOoAgpbfqM","_version":1,"pap":2,"startDate":1575078445221,"status":"Open"}'
    http_version: 
  recorded_at: Sat, 30 Nov 2019 01:47:26 GMT
- request:
    method: post
    uri: http://<API_ENDPOINT>:9000/api/alert/merge/_bulk
    body:
      encoding: UTF-8
      string: '{"alertIds":["15be1f4753cf16c4bf19ab0ff31567ac"],"caseId":"AW65_cCn7fbOoAgpbfqM"}'
    headers:
      Accept-Encoding:
      - gzip;q=1.0,deflate;q=0.6,identity;q=0.3
      Accept:
      - "*/*"
      User-Agent:
      - Ruby
      Host:
      - "<API_ENDPOINT>:9000"
      Content-Type:
      - application/json
      Authorization:
      - Bearer <API_KEY>
  response:
    status:
      code: 201
      message: Created
    headers:
      Date:
      - Sat, 30 Nov 2019 01:47:26 GMT
      Content-Type:
      - application/json
      Content-Length:
      - '364'
    body:
      encoding: UTF-8
      string: '{"owner":"test","severity":2,"_routing":"AW65_cCn7fbOoAgpbfqM","flag":false,"customFields":{},"_type":"case","description":"test","title":"Test
        Alert","createdAt":1575078444256,"_parent":null,"createdBy":"test","caseId":13,"tlp":2,"metrics":{},"_id":"AW65_cCn7fbOoAgpbfqM","id":"AW65_cCn7fbOoAgpbfqM","_version":1,"pap":2,"startDate":1575078445221,"status":"Open"}'
    http_version: 
  recorded_at: Sat, 30 Nov 2019 01:47:27 GMT
recorded_with: VCR 5.0.0
