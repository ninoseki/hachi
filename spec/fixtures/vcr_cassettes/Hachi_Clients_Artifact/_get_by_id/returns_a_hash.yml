---
http_interactions:
- request:
    method: post
    uri: http://<API_ENDPOINT>:9000/api/case
    body:
      encoding: UTF-8
      string: '{"title":"test","description":"test"}'
    headers:
      Accept-Encoding:
      - gzip;q=1.0,deflate;q=0.6,identity;q=0.3
      Accept:
      - "*/*"
      User-Agent:
      - Ruby
      Host:
      - "<API_ENDPOINT>:9000"
      Content-Type:
      - application/json
      Authorization:
      - Bearer <API_KEY>
  response:
    status:
      code: 201
      message: Created
    headers:
      Date:
      - Sun, 18 Aug 2019 05:26:45 GMT
      Content-Type:
      - application/json
      Content-Length:
      - '358'
    body:
      encoding: UTF-8
      string: '{"owner":"test","severity":2,"_routing":"AWyjMS09loCWo96KV7Ja","flag":false,"customFields":{},"_type":"case","description":"test","title":"test","createdAt":1566106003867,"_parent":null,"createdBy":"test","caseId":10,"tlp":2,"metrics":{},"_id":"AWyjMS09loCWo96KV7Ja","id":"AWyjMS09loCWo96KV7Ja","_version":1,"pap":2,"startDate":1566106004796,"status":"Open"}'
    http_version: 
  recorded_at: Sun, 18 Aug 2019 05:26:46 GMT
- request:
    method: post
    uri: http://<API_ENDPOINT>:9000/api/case/AWyjMS09loCWo96KV7Ja/artifact
    body:
      encoding: UTF-8
      string: '{"data":"example.com","dataType":"domain","message":"test"}'
    headers:
      Accept-Encoding:
      - gzip;q=1.0,deflate;q=0.6,identity;q=0.3
      Accept:
      - "*/*"
      User-Agent:
      - Ruby
      Host:
      - "<API_ENDPOINT>:9000"
      Content-Type:
      - application/json
      Authorization:
      - Bearer <API_KEY>
  response:
    status:
      code: 201
      message: Created
    headers:
      Date:
      - Sun, 18 Aug 2019 05:26:46 GMT
      Content-Type:
      - application/json
      Content-Length:
      - '388'
    body:
      encoding: UTF-8
      string: '{"_routing":"AWyjMS09loCWo96KV7Ja","reports":{},"data":"example.com","dataType":"domain","_type":"case_artifact","sighted":false,"message":"test","tags":[],"createdAt":1566106005874,"_parent":"AWyjMS09loCWo96KV7Ja","createdBy":"test","tlp":2,"_id":"c9159b414efb2773de4d6ef89244dbd7","id":"c9159b414efb2773de4d6ef89244dbd7","ioc":false,"_version":1,"startDate":1566106005875,"status":"Ok"}'
    http_version: 
  recorded_at: Sun, 18 Aug 2019 05:26:47 GMT
- request:
    method: get
    uri: http://<API_ENDPOINT>:9000/api/case/artifact/c9159b414efb2773de4d6ef89244dbd7
    body:
      encoding: US-ASCII
      string: ''
    headers:
      Accept-Encoding:
      - gzip;q=1.0,deflate;q=0.6,identity;q=0.3
      Accept:
      - "*/*"
      User-Agent:
      - Ruby
      Host:
      - "<API_ENDPOINT>:9000"
      Authorization:
      - Bearer <API_KEY>
  response:
    status:
      code: 200
      message: OK
    headers:
      Set-Cookie:
      - THE-HIVE-XSRF-TOKEN=630b26f2849f208e3809dc07df1613a2e1af685d-1566106006880-7c1acb9a1065d441cca2507e;
        Path=/
      Date:
      - Sun, 18 Aug 2019 05:26:46 GMT
      Content-Type:
      - application/json
      Content-Length:
      - '388'
    body:
      encoding: UTF-8
      string: '{"_routing":"AWyjMS09loCWo96KV7Ja","reports":{},"data":"example.com","dataType":"domain","_type":"case_artifact","sighted":false,"message":"test","tags":[],"createdAt":1566106005874,"_parent":"AWyjMS09loCWo96KV7Ja","createdBy":"test","tlp":2,"_id":"c9159b414efb2773de4d6ef89244dbd7","id":"c9159b414efb2773de4d6ef89244dbd7","ioc":false,"_version":1,"startDate":1566106005875,"status":"Ok"}'
    http_version: 
  recorded_at: Sun, 18 Aug 2019 05:26:47 GMT
recorded_with: VCR 5.0.0
